# üöÄ Operation: Shadow Breaker ‚Äì The Ultimate Android Pentesting Roadmap
## üéÆ Story Mode: The Elite Consultant
Tum **SecureCorp** ke liye kaam karne wale ek **Elite Mobile Security Consultant** ho. Tumhari reputation itni strong hai ki tumhe **5+ Years Experience** wale senior role ke liye interview kiya ja raha hai. Interviewers ne tumhe 3 targets diye hain jo unke infrastructure ka hissa hain.

Tumhara mission hai in teeno ko todna, report karna, aur fix batana. Agar tumne ye roadmap follow kiya, toh tumhare paas wo **Proof of Work (Portfolio)** hoga jo kisi bhi interviewer ko chup kara dega.

**‚ö†Ô∏è Critical Rule:** Is roadmap mein har step ka **Expected Output** diya gaya hai. Agar tumhara output match nahi karta, toh ruko aur debug karo. Bahar kuch search nahi karna hai. Sab kuch yahan hai.

---

## üìÇ Target Applications (Download These First)
Ye teeno apps tumhara lab hain. Inhe download karke save kar lo.
1.  **Native (Java/Kotlin):** [InsecureBankv2](https://github.com/payatu/insecureBankv2) (GitHub se `InsecureBankv2.apk` aur Backend code).
2.  **Flutter:** [FlutterGoat](https://github.com/OWASP/FlutterGoat) (GitHub se latest release APK).
3.  **API + React Native:** [crAPI](https://github.com/OWASP/crAPI) (GitHub se `deploy/docker` aur Mobile App).

---

## üèÜ Rank System (Tumhara Career Growth)
1.  **Script Kiddie** (Module 0-2 Complete)
2.  **Mobile Pentester** (Module 3-5 Complete)
3.  **Senior Security Engineer** (Module 6-8 Complete)
4.  **Lead AppSec Consultant** (Module 9 + Capstone Complete)

---

## üß© Module 0: The Armory (Lab Setup)
**Goal:** Bulletproof environment. 5+ years exp wale log setup mein hi time waste nahi karte.
**OWASP Reference:** MSTG-ENV-1

### 1. Setup Checklist
-   **OS:** Kali Linux (VirtualBox/VMware) or Windows + WSL2.
-   **Emulator:** Genymotion (Android 10 - Rooted). *Note: Android 11+ mein system root mushkil hota hai.*
-   **Tools:** Burp Suite Community/Pro, JDK 11, Android SDK (Platform-tools), Python 3, Frida, Objection, JADX, MobSF, Ghidra, ADB.

### 2. Practical Tasks
1.  **Genymotion Setup:** Install karo, Google APIs wala image choose karo.
2.  **Burp Certificate:** Burp ka CA cert emulator ke **System Store** mein daalo (`adb root`, `adb remount`, `adb push`).
3.  **Frida Server:** Emulator architecture check karo (`adb shell getprop ro.product.cpu.abi`). Usi hisab se `frida-server` push karo.

### ‚úÖ Verification (Flag Output)
Agar tumne sahi setup kiya hai, toh ye commands ye output dengi:

```bash
# Command 1: Device Check
adb devices
# ‚úÖ Expected Output:
# List of devices attached
# 192.168.56.101:5555    device

# Command 2: Root Check
adb shell whoami
# ‚úÖ Expected Output:
# root

# Command 3: Frida Check
frida-ps -U
# ‚úÖ Expected Output: (Process list dikhegi bina error ke)
# PID  Name
# 1    init
# ...
# 1234 com.android.insecurebankv2
```

üèÜ **Module 0 Flag:** `flag{environment_secure}` (Apne notes mein likho ki setup complete hai)

---

## üß© Module 1: Static Analysis (Native - InsecureBankv2)
**Goal:** Bina app chalaye uske raaz khoolna.
**OWASP Reference:** MSTG-RES-1, MSTG-RES-2

### 1. Practical Tasks
1.  **Decompile:** `jadx-gui InsecureBankv2.apk` open karo.
2.  **Manifest Hunting:** `AndroidManifest.xml` mein `android:exported="true"` dhundho.
3.  **Secret Hunting:** Search bar mein ye keywords daalo: `password`, `api_key`, `token`, `aws`, `firebase`.
4.  **MobSF Scan:** APK ko MobSF mein upload karo aur report compare karo manual findings se.

### ‚úÖ Verification (Flag Output)
InsecureBankv2 mein ek hardcoded password hota hai.
```java
// JADX mein search karo: "Hardcoded"
// ‚úÖ Expected Output (Code snippet):
String password = "password123"; // Ya similar hardcoded string
```
**Task:** Is string ko screenshot lo.
üèÜ **Module 1 Flag:** `flag{static_secrets_found}`

‚ö†Ô∏è **Pro Tip:** Sirf strings mat dhundho. `strings.xml` aur `build.gradle` bhi check karo. Wahan se bhi API keys leak hoti hain.

---

## üß© Module 2: Traffic & SSL Pinning (Native)
**Goal:** HTTPS traffic ko plaintext mein dekhna.
**OWASP Reference:** MSTG-NET-1

### 1. Practical Tasks
1.  **Basic Intercept:** Burp proxy set karo. Traffic aa raha hai?
2.  **Pinning Detection:** Agar traffic nahi aa raha aur network error aa raha hai, toh Pinning hai.
3.  **Bypass 1 (Objection):** `objection -g com.android.insecurebankv2 explore` -> `android sslpinning disable`.
4.  **Bypass 2 (Frida Script):** Universal SSL Pinning bypass script use karo.
5.  **Bypass 3 (Patch):** `apk-mitm` se APK patch karke reinstall karo.

### ‚úÖ Verification (Flag Output)
Burp Suite ke **HTTP History** tab mein:
```http
# ‚úÖ Expected Output:
POST /login HTTP/1.1
Host: 192.168.x.x
...
username=admin&password=password123
```
Agar tumhe ye request dikhi bina TLS error ke, toh pinning bypass ho gaya.
üèÜ **Module 2 Flag:** `flag{traffic_intercepted}`

‚ö†Ô∏è **Industry Reality:** Banks ab **Certificate Transparency** aur **Custom TrustManagers** use karte hain. Objection kabhi-kabhi fail hota hai. Us case mein `jadx` mein `TrustManager` class dhundh kar usse Frida se hook karna padta hai.

---

## üß© Module 3: Runtime Manipulation (Native)
**Goal:** App ke dimaag (Memory) ke saath khelna.
**OWASP Reference:** MSTG-RES-8, MSTG-AUTH-1

### 1. Practical Tasks
1.  **Root Detection Bypass:** App open hote hi band ho rahi hai? `objection` mein `android root disable` chalao.
2.  **Function Hooking:** Login function ko hook karo jo return value `true` kar de.
3.  **Memory Dump:** `android memory dump all` se heap dump lo aur usme secrets dhundho.

### ‚úÖ Verification (Flag Output)
Frida Console Output:
```javascript
// ‚úÖ Expected Output (Hook Script):
[+] Hooked function: checkLogin
[+] Argument 0: admin
[+] Return Value changed to: true
[+] Login Successful without valid password!
```
App screen par "Login Success" dikha bina sahi password ke.
üèÜ **Module 3 Flag:** `flag{runtime_manipulated}`

‚ö†Ô∏è **Pro Tip:** Emulator Detection bhi hota hai (Build.FINGERPRINT check). Uske liye `build.prop` spoofing ya Frida hooking ki zaroorat padti hai.

---

## üß© Module 4: Client-Side Vulnerabilities (Native)
**Goal:** Phone ke andar chupa data churana.
**OWASP Reference:** MSTG-STORAGE-1, MSTG-PLATFORM-6

### 1. Practical Tasks
1.  **SharedPreferences:** `/data/data/<package>/shared_prefs/` mein XML files check karo.
2.  **SQLite Database:** `.db` files extract karo aur `DB Browser for SQLite` mein kholo.
3.  **Exported Components:** `adb shell am start -n <package>/<activity>` se bina login ke protected screen kholo.
4.  **Clipboard:** App mein password copy karo, aur clipboard manager se check karo ki plaintext toh nahi hai.

### ‚úÖ Verification (Flag Output)
ADB Shell Command:
```bash
adb shell "run-as com.android.insecurebankv2 cat /data/data/com.android.insecurebankv2/shared_prefs/prefs.xml"
# ‚úÖ Expected Output:
<?xml version='1.0' encoding='utf-8' standalone='yes' ?>
<map>
    <string name="password">password123</string> <!-- Plaintext password! -->
</map>
```
üèÜ **Module 4 Flag:** `flag{data_leaked}`

‚ö†Ô∏è **Industry Reality:** Modern apps **EncryptedSharedPreferences** use karti hain. Agar data encrypted mile, toh key dhundhna next step hota hai (usually Native code mein).

---

## üß© Module 5: Advanced Native & JNI (The 5+ Year Skill)
**Goal:** Java/Kotlin ke neeche chupi C/C++ code ko samajhna. Ye tumhe baaki 90% testers se alag banayega.
**OWASP Reference:** MSTG-RES-10

### 1. Practical Tasks
1.  **SO File Analysis:** InsecureBankv2 APK unzip karo -> `lib/arm64-v8a/libnative-lib.so` (Agar nahi hai toh **OWASP MSTG-Hacking-Playground** use karo jisme native code hai).
2.  **Ghidra/IDA:** `.so` file ko Ghidra mein load karo.
3.  **String Extraction:** Native code mein chupe strings nikalo (`strings libnative-lib.so`).
4.  **JNI Hooking:** Frida se native functions ko hook karo (`Interceptor.attach`).

### ‚úÖ Verification (Flag Output)
Ghidra Strings Window:
```text
# ‚úÖ Expected Output:
0x0045A200  "SecretKey_Native_Level_5"
0x0045A210  "AES_Encryption_Key_Here"
```
Agar tumne native binary mein se key nikal li, toh tumne encryption tod diya.
üèÜ **Module 5 Flag:** `flag{native_hacker}`

---

## üß© Module 6: Cross-Platform ‚Äì Flutter (FlutterGoat)
**Goal:** Non-Native apps ko pentest karna.
**OWASP Reference:** MSTG-PLATFORM-8

### 1. Practical Tasks
1.  **Binary Analysis:** FlutterGoat APK unzip karo -> `lib/arm64-v8a/libapp.so`.
2.  **Tool:** `strings` command ya `flutter_dissassembler` use karo.
3.  **Pinning:** Flutter mein pinning alag hoti hai. `reflutter` tool use karo.
    *   Command: `reflutter --app FlutterGoat.apk --cert burp.pem`
4.  **Install Patched:** `adb install FlutterGoat_reflutter.apk`.

### ‚úÖ Verification (Flag Output)
Command:
```bash
strings libapp.so | grep -i "flag"
# ‚úÖ Expected Output:
flutter_secret_key_12345
```
Burp Traffic (Flutter):
```http
# ‚úÖ Expected Output:
X-Client-Version: Flutter-1.0
# Traffic successfully decrypted after reflutter patch
```
üèÜ **Module 6 Flag:** `flag{cross_platform_master}`

‚ö†Ô∏è **Pro Tip:** Flutter apps mein strings obfuscated hoti hain. Agar `strings` command se na mile, toh Ghidra mein `const char *` references dhundho.

---

## üß© Module 7: Cross-Platform ‚Äì React Native (crAPI Mobile)
**Goal:** JavaScript Bundle ko reverse karna.
**OWASP Reference:** MSTG-PLATFORM-8

### 1. Practical Tasks
1.  **Bundle Extraction:** crAPI Mobile APK unzip karo -> `assets/index.android.bundle`.
2.  **Deobfuscation:** `unbundle` tool ya online beautifier use karo.
3.  **Search:** `api_key`, `secret`, `endpoint`.
4.  **Frida Hooking:** React Native ke JavaScript functions ko hook karne ke liye `frida-react-native` scripts use karo.

### ‚úÖ Verification (Flag Output)
VS Code mein Bundle open karne par:
```javascript
// ‚úÖ Expected Output:
var API_KEY = "crapi_secret_key_123";
// Ya
fetch('http://vulnerable-api.com/data')
```
üèÜ **Module 7 Flag:** `flag{rn_bundle_hacked}`

---

## üß© Module 8: API Hacking (crAPI Backend)
**Goal:** App ke peeche chupe server ko todna.
**OWASP Reference:** OWASP API Top 10 (IDOR, BOLA, Auth)

### 1. Practical Tasks
1.  **IDOR:** User A ki ID se User B ka data access karo.
2.  **JWT Tampering:** Token ki signature hatao (`alg: none`) ya secret guess karo.
3.  **Mass Assignment:** Registration mein `{"role": "admin"}` inject karo.
4.  **Rate Limiting:** Burp Intruder se login endpoint par 100 requests bhejo.

### ‚úÖ Verification (Flag Output)
Burp Repeater Response:
```json
// ‚úÖ Expected Output (IDOR Success):
{
  "user_id": 3,  // Tumne ID 3 maangi thi (User B)
  "email": "victim@crapi.com",
  "phone": "1234567890"
}
// Status: 200 OK (Bina User B ke login kiye!)
```
üèÜ **Module 8 Flag:** `flag{api_compromised}`

‚ö†Ô∏è **Pro Tip:** Sirf 200 OK mat dekho. Kabhi-kabhi 403 Forbidden bhi data leak karta hai (Error message mein). Hamesha response body padho.

---

## üß© Module 9: Advanced Anti-Analysis & Obfuscation
**Goal:** Commercial protections ko bypass karna (Real World Skill).
**OWASP Reference:** MSTG-RES-11

### 1. Practical Tasks
1.  **ProGuard/R8:** Dekho ki code obfuscate hai ya nahi (`classes.dex` mein class names `a.b.c` hain?).
2.  **Debugger Detection:** App detect karti hai ki Frida attach hai? `frida-detect-hide` scripts use karo.
3.  **Tamper Detection:** App ka signature change karne par app band ho jati hai? Signature spoofing module (Magisk) use karo.
4.  **Anti-Emulation:** App emulator par nahi chalti? `build.prop` values change karo (Frida se).

### ‚úÖ Verification (Flag Output)
Frida Console:
```javascript
// ‚úÖ Expected Output:
[+] Debugger detection bypassed
[+] App running in Genymotion without crashing
```
üèÜ **Module 9 Flag:** `flag{anti_analysis_bypassed}`

---

## üß© Module 10: Reporting & Job Ready (The Money)
**Goal:** Findings ko paise mein badalna.
**OWASP Reference:** OWASP Reporting Guide

### 1. Practical Tasks
1.  **Executive Summary:** CEO ke liye (Risk in Money terms).
2.  **Technical Details:** Developer ke liye (Steps to Reproduce, Code Snippets).
3.  **CVSS Scoring:** Har bug ko score karo (High/Medium/Low).
4.  **Remediation:** Sirf "Fix it" mat likho. Code snippet do ki kaise fix karein.
5.  **Portfolio:** GitHub par apne scripts aur write-ups upload karo.

### ‚úÖ Verification (Flag Output)
Tumhari Report ka Structure:
```markdown
# ‚úÖ Expected Output (Report Section):
## Vulnerability: Insecure Data Storage
**Severity:** High (CVSS 7.5)
**Evidence:** [Screenshot of XML file with password]
**Remediation:** Use Android Keystore System instead of SharedPreferences.
   Code: KeyGenParameterSpec.Builder(...)
```
üèÜ **Module 10 Flag:** `flag{report_submitted}`

---

## üèÅ Final Capstone: "The Black Box Challenge"
**Mission:** Ek aisi app choose karo jo tumne pehle nahi dekhi (GitHub se koi open source banking app).
**Time Limit:** 48 Hours.
**Deliverable:** Full Pentest Report.

**Success Criteria:**
1.  Kam se kam 3 High Severity bugs dhundhne.
2.  Ek PoC Video banana.
3.  Report ko LinkedIn par publish karna (Sensitive info redact karke).

üèÜ **Final Flag:** `flag{job_ready_consultant}`

---

## üí° Industry Secrets (Jo Roadmap Mein Nahi Hote)

1.  **Play Integrity API:** Aaj kal apps check karti hain ki device genuine hai ya nahi. Isse bypass karna bahut mushkil hai. Iske liye **Magisk Hide** aur **Zygisk** seekhna padega.
2.  **Obfuscation:** ProGuard/R8 code ko padhne layak nahi chhodte. **Deobfuscation mapping files** ka intezaar karo ya **de4dot** jaise tools try karo.
3.  **CI/CD Security:** Sirf app mat todo. Uska **GitHub Action** ya **Jenkins pipeline** dekho. Wahan se API keys leak hona aam baat hai.
4.  **Deep Link Fuzzing:** `adb intent` se sirf ek link mat chalaao. **Qark** ya custom script se hazaron deep links fuzz karo.
5.  **Legal:** Hamesha **Written Permission** lo. Bina permission ke testing illegal hai (Computer Fraud and Abuse Act).

---

## üéí Toolkit Summary (Job Interview Cheat Sheet)

| Category | Tools to Master |
| :--- | :--- |
| **Static** | JADX, Ghidra, MobSF, Apktool |
| **Dynamic** | Frida, Objection, Burp Suite, ADB |
| **Network** | Wireshark, Burp Repeater/Intruder |
| **Cross-Platform** | reflutter (Flutter), rn-decryptor (RN) |
| **Backend** | Postman, JWT.io, SQLmap |
| **OS** | Kali Linux, ADB Shell, Bash Scripting |

---

## üöÄ Ab Kya Karein? (Next Steps)
1.  **Day 1-3:** Module 0 & 1 complete karo.
2.  **Day 4-7:** Module 2 & 3 (Traffic & Frida) par master banao.
3.  **Day 8-14:** API Hacking (Module 8) seekho, kyunki jobs yahi maangti hain.
4.  **Day 15-20:** Cross-Platform (Module 6 & 7) aur Native Reversing (Module 5).
5.  **Day 21+:** Reporting aur Capstone par focus karo.

**Yaad rakhna:** Tools change hote hain, concepts nahi. Agar tumhe **HTTP, Encryption, aur Android Architecture** samajh aa gaya, toh tum kisi bhi app ko tod sakte ho.

**All the Best, Hacker!** ü•∑üì±